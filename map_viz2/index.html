<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <style>
        body {
            max-width: 350;
            /* margin-right: auto;
            margin-left: auto;
            margin-top: 10px;
            margin-bottom: 10px;

            margin: 10px auto 10px auto; */

            margin: 10px auto;
        }
        .chart-container {
            max-width: 500px;
            /* background-color: green; */
            border: 3px solid orange;
            /* margin: 0 auto; */
            /* auto centers the div */
            opacity: 1;
            /* animation-name: fadeOutOpacity;
            animation-iteration-count: 2;
            animation-timing-function: ease-in;
            animation-duration: .5s; */
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            float: left;
        }

        .legend-container {
            float: right;
            border: 2px solid black;
            max-width: 100px;
            max-height: 200 px;
            width: 30%;

        }


        p {
            text-align: center;
        }

        svg {
            background-color: white;
            /* overflow: visible; */
        }

        .svg-container {
            /* opacity: 1; */
            border: 3px solid orange;
            max-width: 700px;
            width: 100%;


        }
        .big-container {
            /* border: 3px solid rgb(62, 177, 81); */
            padding: 20px;
        }


        h1 {
            float: left;
        }
        .float-child-map {
            width: 100%;
            float: left;
            padding: 0px;
            border: 1px solid none;
            max-width: 1000px;
        } 

        .float-child-legend {
            width: 10%;
            height:20%;
            float: left;
            padding: 20px;
            border: 2px solid red;
            max-height: 200px;
        } 

        .float-container {
            border: 3px solid #fff;
            padding: 20px;
        }



     
    </style>
</head>

<body>
    
    <div class = "h1"> Centennial Changes in Chicago Population  </div>
    
    
    <div id ="slider">
        <div id="slider-time"></div>
        <div> <p id="value-time"></p></div>
    </div>
        
    
    <div class="svg">
        <div class = "float-container"> 
            <div class = "float-child-map"> 
                <div id="map"> </div> 
            </div>

            <!-- <div class="float-child-legend"> 
                <img src="for_legend2-01.svg"> </img> 
            </div> -->
        </div>
    </div>

    
    <div> 
      <p> Test</p>
    </div>
    

</body>

<!-- add your script blocks at the end -->
<script src="https://d3js.org/d3.v6.min.js"></script>
<script src="https://unpkg.com/d3-simple-slider"></script>
<link
  rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
  integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
  crossorigin="anonymous"
/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"> 
</script>



<script>

    const map_container = d3.select('#map')

    data_1920 = d3.xml("1920.svg")


    console.log({data_1920})
    
    d2 = data_1920
        .then(data => {
            map_container
            .style("opacity", 1)
            .node()
            .append(data.documentElement)})

    console.log({d2})


    function update_chart(year){
        
        console.log("Updating:")
        console.log(year)

        let year_st = String(year)
        let file = year_st + ".svg"
        let map = d3.xml(file)

        map_container.selectAll("*").html(null);
        
        map             
            .then(data => {
                map_container
                .selectAll("*")
                .style("opacity", .1)
                .node()
                .append(data.documentElement) 
            })

        map
            .then(data => {
                map_container
                .selectAll("*")
                .transition()
                .delay(200)
                .duration(500)
                .ease(d3.easeLinear)
                .style("opacity", 1)

            })

           
    }

    // legend = d3.xml("for_legend2-01.svg")
    //     .then(data => {
    //         d3.select("#legend")
    //         //.style("opacity", 1)
    //         .node()
    //         .append(data.documentElement)
    //     })
    
    // console.log({legend})
    





    var dataTime = [1920, 1930, 1940, 1950, 1960, 1970, 1980, 1990, 2000, 2010, 2020]

    console.log({dataTime})

    var sliderTime = d3
        .sliderBottom()
        .min(1920)
        .max(2020)
        .step(10)
        .width(400)
        .tickFormat(d3.format(""))
        .tickValues(dataTime)
        .default(dataTime[0])
        .on('onchange', val => {
            console.log(val)
            d3.select('p#value-time').text(val)
            update_chart(val)
        });

    var gTime = d3
        .select('div#slider-time')
        .append('svg')
        .attr('width', 500)
        .attr('height', 100)
        .append('g')
        .attr('transform', 'translate(35,35)');

    gTime.call(sliderTime);




</script>